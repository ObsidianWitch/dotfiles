pkgname='sdmap'
pkgver=0.5.2
pkgrel=1
pkgdesc='Steam Deck Controller custom mapping'
arch=('x86_64')
url='https://github.com/obsiwitch/dotfiles'

makedepends=('rust')

_prepare() { :; }

_build() {
    cargo build --release
}

_check() {
    cargo test --release
}

_package() {
    install -Dm 755 'target/release/sdmap-'{daemon,sticker} -t "$pkgdir/usr/bin"
    install -Dm 644 'data/sdmap.service' -t "$pkgdir/usr/lib/systemd/system"
    install -Dm 644 'data/71-sdmap.rules' -t "$pkgdir/usr/lib/udev/rules.d"
    install -Dm 644 'data/initcpio/sdmap.build' -T "$pkgdir/usr/lib/initcpio/install/sdmap"
    install -Dm 644 'data/initcpio/sdmap.runtime' -T "$pkgdir/usr/lib/initcpio/hooks/sdmap"
}
