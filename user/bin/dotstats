#!/usr/bin/env python3

import sys, time
from pathlib import Path

def bandwidth(interface, interval):
    netstats = Path(f'/sys/class/net/{interface}/statistics')
    helper = lambda f: int((netstats / f).read_text()[:-1])

    cxold = helper('rx_bytes') + helper('tx_bytes')
    while True:
        cxnew = helper('rx_bytes') + helper('tx_bytes')
        cxdiff = (cxnew - cxold) // interval
        print(f'ï‡« {"%.2fKiB/s" % (cxdiff / 1024)}', flush=True)
        cxold = cxnew
        time.sleep(interval)

if sys.argv[1] == 'bandwidth':
    bandwidth(sys.argv[2], int(sys.argv[3]))
else:
    sys.exit(1)
